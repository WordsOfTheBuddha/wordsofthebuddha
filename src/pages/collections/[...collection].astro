---
export const prerender = false;

import CollectionLayout from "../../layouts/CollectionLayout.astro";
import directoryMetaData from "../../data/directoryMetaData.json";
import { createSearchPattern } from "../../utils/collectionPatterns";

const { collection } = Astro.params as {
	collection: keyof typeof directoryMetaData;
};

interface Metadata {
	title: string;
	description?: string;
}

// Check if collection exists in metadata
const metadata: Metadata = directoryMetaData[collection];
if (!metadata) {
	return Astro.redirect(`/search?q=${collection}`);
}

// Generate search pattern
const searchPattern = createSearchPattern(collection);
if (!searchPattern) {
	return Astro.redirect(`/search?q=${collection}`);
}
---

<CollectionLayout
	title={metadata.title}
	description={metadata.description || ""}
	searchPattern={searchPattern}
/>
